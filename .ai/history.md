# プロジェクト履歴

## 時系列ログ

### 2025-12-27
*   **機能: 価格アラート実装:**
    *   *バックエンド:* `NotificationService` (Discord Webhook) を実装。`PriceService.check_alerts` でアラート条件を評価し通知を送信。
    *   *フロントエンド:* `AlertManager` コンポーネント（作成/削除UI）を実装。`Settings.tsx` に通知設定を追加。
    *   *デバッグ:* 複数のバグを修正（`price_updates` スコープ問題、アイテム自動追跡、DBプール設定）。
*   **機能: 永続アラートオプション:** `PriceAlert` モデルに `is_persistent` カラムを追加。UIでワンタイム/繰り返しを選択可能に。
*   **改善: .env.example 更新:** `REMOTE_DB_HOST` と `COMPOSE_PROFILES` のドキュメントを整備。
*   **プロジェクトドキュメント初期化:** スペック、履歴、タスクを整理するための Single Source of Truth (`.ai/` フォルダ) の作成を開始。
*   **エージェント環境設定:** AIエージェント用のルール (`.agent/rules`) とワークフロー (`.agent/workflows`) を整備。コーディング規約とDBマイグレーション手順を追加。
*   **ドキュメント日本語化:** `.ai/` フォルダ内のドキュメントを日本語に翻訳。

### 2025-12-24
*   **バグ修正 (モバイル):** モバイルデバイスでチャートビューの「戻るボタン」が反応しない問題を解決。
    *   *実装:* `Dashboard.tsx` でタップ領域を拡大し、Z-indexを調整、アイコンに `pointer-events-none` を適用。
*   **検証:** 内部DB機能を確認し、モバイルエミュレーションで修正を検証。

### 2025-12-23
*   **モバイルレスポンシブ対応:** モバイルデバイス向けの大規模なUI刷新。
    *   *リファクタ:* `App.tsx` をデスクトップ用サイドバーとモバイル用ボトムナビゲーションに分離。
    *   *コンポーネント:* `Dashboard.tsx` をマスター詳細ビューに対応。
*   **Tailscale統合:** Docker内で直接Tailscale接続を実装。
    *   *設定:* `docker-compose.yml` に `tailscale` サービス（サイドカーパターン）を追加。

### 2025-12-21
*   **Docker起動デバッグ:** クリーンな状態からの起動問題を解決。
*   **外部DB構成:** 外部のセルフホストデータベースに接続するようにアプリを構成（`Use External DB Server`）。
*   **機能: オーダーブックキャッシング:**
    *   *バックエンド:* `Item` モデルに `orderbook_snapshot` を追加。
    *   *フロントエンド:* `OrderBookButton` がキャッシュされたトップ5出品を表示するように変更。
*   **改善:** 価格取得失敗時のバックオフ戦略を実装。
*   **開発:** `d3-path` のTypeScript型エラーを修正。
*   **機能強化:** 並列APIリクエスト (asyncio.gather) と「追跡停止」UIを追加。

### 2025-12-20
*   **プロジェクトセットアップ:** "TMC_V2" 書き換え（アーキテクチャの近代化）を初期化。
*   **比較:** V1とV2の詳細な比較を実施。

### 2025-12-17
*   **データベースマイグレーション:** SQLAlchemyクエリにおける MySQL `NULLS FIRST` 互換性の問題を修正。
*   **UI調整:** オーダーブックチャートのオーバーレイを半透明化。
*   **コントロール:** 手動の「今すぐスキャン」および「クローラーサイクル実行」ボタンを追加。
*   **デバッグ:** CSS appearance の警告対応およびチャートツールの一般的なデバッグ。
